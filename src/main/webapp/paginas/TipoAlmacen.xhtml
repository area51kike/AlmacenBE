<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Tipo de Almacén</title>
    <link rel="stylesheet" type="text/css" href="#{request.contextPath}/resources/estilos/disenoAlmacen.css" />
</head>
<body>
<div class="container">
    <div class="header">
        <h1>#{tipoAlmacenFrm.nombreBean}</h1>
    </div>

    <div class="content">
        <!-- Formulario principal con AJAX para evitar recarga completa -->
        <h:form id="frmPrincipal">
            <h:panelGroup id="panelCompleto">

                <!-- Tabla que muestra todos los registros existentes -->
                <h:dataTable value="#{tipoAlmacenFrm.listaTipoAlmacen}" var="r" styleClass="data-table">
                    <h:column>
                        <f:facet name="header">ID</f:facet>
                        #{r.id}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Nombre</f:facet>
                        #{r.nombre}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Estado</f:facet>
                        <span class="badge #{r.activo ? 'badge-activo' : 'badge-inactivo'}">
                            #{r.activo ? 'Activo' : 'Inactivo'}
                        </span>
                    </h:column>
                    <h:column>
                        <f:facet name="header">Observaciones</f:facet>
                        #{r.observaciones != null ? r.observaciones.toUpperCase() : ''}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Acciones</f:facet>
                        <!-- Botón para eliminar un registro con confirmación -->
                        <h:commandButton value="Eliminar"
                                         actionListener="#{tipoAlmacenFrm.btnEliminarHandler(r)}"
                                         styleClass="btn-eliminar"
                                         onclick="return confirm('¿Está seguro que desea eliminar este registro?');">
                            <f:ajax execute="@this" render="panelCompleto" />
                        </h:commandButton>
                    </h:column>
                </h:dataTable>

                <!-- Botón para mostrar el formulario de creación -->
                <h:commandButton value="Nuevo" actionListener="#{tipoAlmacenFrm.btnNuevoHandler}"
                                 styleClass="btn-submit btn-nuevo">
                    <f:ajax execute="@this" render="panelCompleto" />
                </h:commandButton>

                <!-- Sección del formulario para crear un nuevo registro -->
                <h:panelGroup rendered="#{tipoAlmacenFrm.mostrarFormulario}">
                    <div class="form-section">
                        <h2>Nuevo Tipo de Almacén</h2>

                        <!-- Muestra mensajes de validación o éxito -->
                        <h:messages styleClass="error-message" />

                        <div class="form-grid">
                            <!-- Campo informativo del próximo ID sugerido -->
                            <div class="form-group">
                                <h:outputLabel for="lblProximoId" value="ID (Asignado automáticamente):" />
                                <h:outputText id="lblProximoId" value="#{tipoAlmacenFrm.proximoId}"
                                              styleClass="form-control-readonly" />
                            </div>

                            <!-- Campo obligatorio para el nombre del tipo de almacén -->
                            <div class="form-group">
                                <h:outputLabel for="txtNombre" value="Nombre:" />
                                <h:inputText id="txtNombre" value="#{tipoAlmacenFrm.registro.nombre}"
                                             size="75" styleClass="form-control" required="true"
                                             requiredMessage="El nombre es obligatorio"/>
                            </div>

                            <!-- Campo opcional para observaciones -->
                            <div class="form-group">
                                <h:outputLabel for="txtObservaciones" value="Observaciones:" />
                                <h:inputText id="txtObservaciones" value="#{tipoAlmacenFrm.registro.observaciones}"
                                             size="75" styleClass="form-control" required="false"/>
                            </div>
                        </div>

                        <!-- Botón para guardar el nuevo registro -->
                        <h:commandButton value="Crear" actionListener="#{tipoAlmacenFrm.btnGuardarHandler}"
                                         styleClass="btn-submit">
                            <f:ajax execute="@form" render="panelCompleto" />
                        </h:commandButton>
                    </div>
                </h:panelGroup>
            </h:panelGroup>
        </h:form>
    </div>
</div>
</body>
</html>
